<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="assets/style.css">
  <title>Grid‑City Tycoon Prototype</title>
  <style>
    body { margin:0; font-family: sans-serif; background: #e0f7fa; }
    #game-container { display:flex; height:100vh; }
    #sidebar {
      width: 300px;
      background: #004d40;
      color: white;
      padding: 20px;
      box-sizing: border-box;
    }
    #map {
      flex: 1;
      position: relative;
      background: #a7d7c5;
      overflow: hidden;
    }
    .tile {
      position: absolute;
      border: 1px solid #888;
      box-sizing: border-box;
      pointer-events: none;
    }
    .building {
      position: absolute;
      border: 2px solid #333;
      box-sizing: border-box;
      background-color: rgba(100,100,100,0.8);
      color: white;
      font-size: 12px;
      text-align: center;
      cursor: grab;
    }
    .grid-highlight {
      background-color: rgba(0, 255, 0, 0.3);
      pointer-events: none;
    }
    button, select, input { margin:5px 0; padding:5px; width:100%; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="index.html">Rowan's Projects</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
          <li class="nav-item">
          <a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item active">
          <a class="nav-link" href="mini city.html">Mini City</a>
          </li>
          <li class="nav-item">
          <a class="nav-link" href="build racers.html">Build Racers</a>
          </li>
      </ul>
      </div>
  </nav>
  <div id="game-container">
    <div id="sidebar">
      <h2>City Tycoon Prototype</h2>
      <label>Building Name:</label><br>
      <input id="building-name" placeholder="Name it"><br>
      <label>Type:</label><br>
      <select id="building-type">
        <option value="house">House (i4eyesore)</option>
        <option value="concert">Concert Hall</option>
        <option value="soccer">Soccer Arena</option>
        <option value="football">Football Arena</option>
        <option value="basketball">Basketball Arena</option>
      </select><br>
      <label>Size (tiles):</label><br>
      <select id="building-size">
        <option value="1">1×1 (XS)</option>
        <option value="2">2×2 (S)</option>
        <option value="3">3×3 (M)</option>
        <option value="4">4×4 (L)</option>
        <option value="5">5×5 (XL)</option>
      </select><br>
      <button id="start-place">Place Building</button>
      <h3>Money: $<span id="money">0</span></h3>
      <h4>Upgrades</h4>
      <div id="upgrade-panel">
        <p>Select a building to upgrade.</p>
      </div>
    </div>
    <div id="map"></div>
  </div>

  <script>
    // CONFIG
    const TILE_SIZE = 50; // px
    const GRID_WIDTH = 20;
    const GRID_HEIGHT = 12;

    const mapDiv = document.getElementById('map');
    let money = 0;
    const moneySpan = document.getElementById('money');
    let placing = false;
    let currentFootprint = 1;
    let currentType = "";
    let currentName = "";

    // grid state: 2D array, true if occupied
    const grid = [];
    for(let x=0; x<GRID_WIDTH; x++){
      grid[x] = [];
      for(let y=0; y<GRID_HEIGHT; y++){
        grid[x][y] = null;
      }
    }

    // draw grid
    for(let x=0; x<GRID_WIDTH; x++){
      for(let y=0; y<GRID_HEIGHT; y++){
        const t = document.createElement('div');
        t.className = 'tile';
        t.style.left = (x * TILE_SIZE) + 'px';
        t.style.top = (y * TILE_SIZE) + 'px';
        t.style.width = TILE_SIZE + 'px';
        t.style.height = TILE_SIZE + 'px';
        mapDiv.appendChild(t);
      }
    }

    // highlight overlay
    const highlight = document.createElement('div');
    highlight.className = 'grid-highlight';
    highlight.style.width = TILE_SIZE + 'px';
    highlight.style.height = TILE_SIZE + 'px';
    mapDiv.appendChild(highlight);

    // handle placing
    document.getElementById('start-place').onclick = () => {
      placing = true;
      currentFootprint = parseInt(document.getElementById('building-size').value);
      currentType = document.getElementById('building-type').value;
      currentName = document.getElementById('building-name').value || 'Unnamed';
    };

    mapDiv.addEventListener('mousemove', e => {
      if(!placing) return;
      const rect = mapDiv.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;
      const gx = Math.floor(mx / TILE_SIZE);
      const gy = Math.floor(my / TILE_SIZE);
      highlight.style.width = (TILE_SIZE * currentFootprint) + 'px';
      highlight.style.height = (TILE_SIZE * currentFootprint) + 'px';
      highlight.style.left = gx * TILE_SIZE + 'px';
      highlight.style.top = gy * TILE_SIZE + 'px';
    });

    mapDiv.addEventListener('click', e => {
      if(!placing) return;
      const rect = mapDiv.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;
      const gx = Math.floor(mx / TILE_SIZE);
      const gy = Math.floor(my / TILE_SIZE);

      // check occupancy & bounds
      let valid = true;
      for(let dx=0; dx<currentFootprint; dx++){
        for(let dy=0; dy<currentFootprint; dy++){
          if(gx+dx >= GRID_WIDTH || gy+dy >= GRID_HEIGHT) valid = false;
          else if(grid[gx+dx][gy+dy]) valid = false;
        }
      }
      if(!valid){
        alert('Cannot place here!');
        return;
      }

      // place building
      const b = document.createElement('div');
      b.className = 'building';
      b.style.width = (TILE_SIZE * currentFootprint) + 'px';
      b.style.height = (TILE_SIZE * currentFootprint) + 'px';
      b.style.left = (gx * TILE_SIZE) + 'px';
      b.style.top = (gy * TILE_SIZE) + 'px';
      b.innerText = currentName + '\\n(' + currentType + ')';

      mapDiv.appendChild(b);

      // mark grid occupied
      for(let dx=0; dx<currentFootprint; dx++){
        for(let dy=0; dy<currentFootprint; dy++){
          grid[gx+dx][gy+dy] = { type: currentType, name: currentName, footprint: currentFootprint, level: 1, income: 1 };
        }
      }

      // small example: building gives passive income periodically
      const buildingData = grid[gx][gy];  // root cell
      setInterval(() => {
        money += buildingData.income;
        moneySpan.innerText = money;
      }, 3000);

      placing = false;
    });

  </script>
</body>
</html>
